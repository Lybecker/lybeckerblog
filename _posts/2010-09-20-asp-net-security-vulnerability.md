---

title: ASP.Net Security Vulnerability
date: 2010-09-20T19:54:14+01:00


guid: http://www.lybecker.com/blog/?p=737
permalink: /blog/2010/09/20/asp-net-security-vulnerability/
dsq_thread_id:
  - "3706714628"
  - "3706714628"
categories:
  - .Net
  - Announcement
  - Security
tags:
  - ASP.Net Vulnerability
  - Security
---
Friday the September 17th a serious [security exploit](http://www.microsoft.com/technet/security/advisory/2416728.mspx "Microsoft Security Advisory (2416728) Vulnerability in ASP.NET Could Allow Information Disclosure ") was demonstrated at security conference by Juliano Rizzo and Thai Duong. A tool called POET (Padding Oracle Exploit Tool) was used to show the exploit in both .Net and Java.

POET exploits a well-known vulnerability in the way many websites encrypt text stored in ViewState, form authentication tickets, cookies, hidden HTML fields and request parameters.

It a deficiency in the encryption libraries in both Java and the .Net framework utilizing the fact that encrypted strings are padded in blocks of e.g. 8 bytes or 16 bytes or …. I will not go into details, as it is explained well in details [here](http://www.gdssecurity.com/l/b/2010/09/14/automated-padding-oracle-attacks-with-padbuster/ "Article Automated Padding Oracle Attacks with PadBuster").

The exploit works on any [block-cipher encryption](http://en.wikipedia.org/wiki/Block_cipher "Block cipher on Wikipedia") mechanism, such as AES, DES and Triple DES.

The exploit is quite severe, as it can be used to download the web.config file.

> The attack that was shown in the public relies on a feature in ASP.NET that allows files (typically javascript and css) to be downloaded, and which is secured with a key that is sent as part of the request. Unfortunately if you are able to forge a key you can use this feature to download the web.config file of an application (but not files outside of the application). We will obviously release a patch for this… [Scott Gu](http://weblogs.asp.net/scottgu/archive/2010/09/18/important-asp-net-security-vulnerability.aspx "Comment by Scott Gu")

There are lots of systems affected, such as ASP.Net 1.0-4.0 (WebForms and MVC), SharePoint, Microsoft CRM, JavaServer Faces etc.

HTTPS with SSL/TLS does not protect your site.

Below is a video showing how to use the POET tool with DotNetNuke.


Scott Gu has [workaround details until Microsoft releases a patch](http://weblogs.asp.net/scottgu/archive/2010/09/18/important-asp-net-security-vulnerability.aspx "ASP.Net workaround").

**Update** September 29th, 2010: A [security update](http://www.microsoft.com/technet/security/bulletin/ms10-070.mspx "Microsoft Security Bulletin MS10-070 - Important") is released by Microsoft. More details about the patch on [Scott Gu's blog](http://weblogs.asp.net/scottgu/archive/2010/09/28/asp-net-security-update-now-available.aspx "Details of the ASP.NET Security Update").
